# 直線 ($D_{\infty h}$) 配置の平衡解析

4 粒子が 1 本の直線上 (x 軸) に配置された 3 次元 4 体 Lennard-Jones (6,12) 系を解析する。ポテンシャルは既報と同じ規格化単位系 ($\epsilon = \sigma = 1$) を用い、

$$
V(r) = 4\left[\left(\frac{1}{r}\right)^{12} - \left(\frac{1}{r}\right)^6\right]
$$

とする。

## 幾何学的パラメータと記号

- 粒子 0〜3 を左から右へ番号付けし、位置を $x_0=0$, $x_1=a$, $x_2=a+b$, $x_3=2a+b$ と表す (全て $y=z=0$)。
- 隣接間隔は $r_{01} = r_{23} = a$、中央間隔は $r_{12} = b$。反射対称性から右端の $r_{34}$ も $a$ に一致する。
- 残りの距離は $r_{02} = r_{13} = a + b$、$r_{03} = 2a + b$ で決まる。

力の釣り合い条件に使う 1 次元力を

$$
g(r) := -V'(r) = 24\,\frac{2 - r^6}{r^{13}}
$$

と定義する。$g(r)>0$ なら反発、$g(r)<0$ なら引力で、距離が $r_\mathrm{eq} = 2^{1/6} \approx 1.12246$ を超えると符号が負に変わる。

## 力の釣り合い条件

直線配置は $D_{\infty h}$ 対称性を持つため、未知数は $a>0$, $b>0$ の 2 つだけで済む。各粒子の x 方向力をゼロにする条件は以下の 2 式で与えられる:

1. **外側粒子 (粒子 0)**

   $$
   F_{\text{out}}(a, b) := g(a) + g(a + b) + g(2a + b) = 0.
   $$

   最も近い隣接粒子 ($r=a$) からは反発 (正)、離れた 2 粒子 ($r = a+b, 2a+b$) からは弱い引力 (負) が働き、これらが打ち消し合う点を探す。

2. **内側粒子 (粒子 1)**

   $$
   F_{\text{in}}(a, b) := -g(a) + g(b) + g(a + b) = 0.
   $$

   左右の隣接距離は異なるが、反射対称性により粒子 2 でも同じ式が成立する。

関数 $g(r)$ は $r>0$ で滑らかかつ単調減少 ($0 < r \lesssim 1.244$) から単調増加 ($r \gtrsim 1.244$) へと移行するため、$F_{\text{out}}$ と $F_{\text{in}}$ はそれぞれに対して一意的な解を与える。初期推定 $(a, b) = (1.12, 1.12)$ からニュートン法を適用すると、以下の解に収束する:

$$
\boxed{\;a = 1.120938907766685\;},\qquad \boxed{\;b = 1.119539634328144\;}.
$$

対応する距離は

| ペア | 距離 |
| :--- | :--- |
| $r_{01} = r_{23}$ | $1.120938907766685$ |
| $r_{12}$ | $1.119539634328144$ |
| $r_{02} = r_{13}$ | $2.240478542094829$ |
| $r_{03}$ | $3.361417449861514$ |

である。反発 (短距離) と引力 (長距離) のバランスが取れており、1 粒子が飛び出すと残り 3 粒子は必ず元の線分内で反応するため、束縛平衡として成立する。

## エネルギーと力の残差

上記の $(a,b)$ を用いると、全ポテンシャルエネルギーは

$$
E = V(r_{01}) + V(r_{12}) + V(r_{23}) + V(r_{02}) + V(r_{13}) + V(r_{03}) = -3.0651362881017983.
$$

`uv run` で評価した全粒子の力ノルムは $\lVert \mathbf{F} \rVert_2 \approx 2.8\times10^{-14}$ と機械誤差レベルであり、ニュートン収束後の残差が十分に小さいことを確認した。

## ヘッセ行列と線形安定性

LJ ポテンシャルのヘッセ行列 $H$ (12×12) を構成し、固有値を計算すると次を得る。

| 役割 | 固有値 $\lambda$ (ω²) | 備考 |
| :--- | :-------------------- | :--- |
| 不安定 (2 重) | $-0.3868177754$ | 中央 2 粒子が大きく、外側が小さく振れる曲げモード (y, z の排他的 2 軸が縮退) |
| 不安定 (2 重) | $-0.0831291613$ | 外側と内側が同位相で撓む長波長の曲げモード (同じく y, z 軸の縮退) |
| ゼロ (5 本) | $\approx 0$ | 並進 3、本質的な回転 2。線上配置では軸回りの回転は恒等写像となるためゼロに現れない |
| 安定 (3 本) | $34.4338390$, $117.0754889$, $203.3088418$ | 全て純粋に x 方向の伸縮モードで正値 |

負固有値の固有ベクトルを正規化してみると、$\lambda=-0.3868$ のモードでは $(P_0,P_3)$ が小振幅で片側に歪み、$(P_1,P_2)$ が反対向きに大振幅で曲がる「アンチシンメトリック曲げ」と読める。$\lambda=-0.0831$ のモードは $(P_0,P_3)$ と $(P_1,P_2)$ が同符号で揺れる「シンメトリック曲げ」であり、2 軸に縮退した面外撓みが線形鎖を不安定方向へ導く。

ヘッセ行列の x 成分のみを抜き出した 4×4 サブブロック $H_x$ の固有値は

$$
\{\,-4.4\times10^{-15},\; 34.4338390,\; 117.0754889,\; 203.3088418\,\}
$$

で、自由度に起因するゼロモードを除けば正定値である。従って、一次元的な伸縮に関しては局所的に安定、しかし任意の微小曲げ擾乱に対しては指数発散 (index-4 の鞍点) となる。

## 数値検証と再現手順

本解析では以下のような 2 変数ニュートン法を `uv run` 上で実装し、`lj4_equilibrium_search` の `all_forces` / `build_hessian` を再利用して解を検証した。

```bash
UV_CACHE_DIR=.uv_cache \\
uv run python - <<'PY'
import numpy as np
import sys
sys.path.append('src')
import lj4_equilibrium_search as lj

def residuals(a, b):
    pos = np.array([[0.,0.,0.],[a,0.,0.],[a+b,0.,0.],[2*a+b,0.,0.]])
    forces = lj.all_forces(pos)
    return np.array([forces[0,0], forces[1,0]])

def jacobian(a, b, h=1e-9):
    r0 = residuals(a, b)
    ra = residuals(a+h, b)
    rb = residuals(a, b+h)
    return np.column_stack(((ra-r0)/h, (rb-r0)/h))

def newton(a, b):
    for _ in range(50):
        r = residuals(a, b)
        if np.linalg.norm(r, np.inf) < 1e-14:
            return a, b
        J = jacobian(a, b)
        da, db = np.linalg.solve(J, -r)
        a, b = a + da, b + db
    raise RuntimeError('no convergence')

a, b = newton(1.12, 1.12)
print(a, b)
pos = np.array([[0.,0.,0.],[a,0.,0.],[a+b,0.,0.],[2*a+b,0.,0.]])
print('energy', lj.total_potential(pos))
H = lj.build_hessian(pos)
print('evals', np.linalg.eigvalsh(0.5*(H+H.T)))
PY
```

出力は本節で引用した値と一致する。`src/lj4_equilibrium_search.py` 側には、この初期値に微小な横ずれを加えた手動シードを追加してあり、マルチスタート探索でも直線平衡が自動検出されるようになっている。

## まとめ

- 4 体 LJ 系の直線配置は $(a, b) = (1.1209389078, 1.1195396343)$ の一意解を持ち、エネルギーは $E = -3.0651362881$。
- 一次元的な伸縮は安定だが、面外曲げの 4 本のモードが負固有値を持つため index-4 の鞍点である。
- 解析結果は `uv run` 上の数値解とヘッセ行列の固有値解析で検証済みであり、探索スクリプトにもシードとして組み込んだ。


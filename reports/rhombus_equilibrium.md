# 菱形 ($D_{2h}$) 配置の平衡距離条件（再検討）

4 粒子が同一平面上で菱形をなす配置を考える。辺長を $a>0$、ある頂点の内角を $0 < \theta < \pi$ とし、レナード–ジョーンズ (6,12) ポテンシャル

$$
V(r) = 4\left[\left(\frac{1}{r}\right)^{12} - \left(\frac{1}{r}\right)^6\right]
$$

に従うとする ($\epsilon=\sigma=1$)。

## 幾何学的準備

- 隣接する 2 粒子の距離はすべて $a$。
- 短い対角線の長さを $p = 2a\cos(\theta/2)$、長い対角線の長さを $q = 2a\sin(\theta/2)$ と書く。
- 対角線に関する鏡映対称性により、鋭角頂点 ($\theta$) も鈍角頂点 ($\pi-\theta$) も、それぞれの角の二等分線方向に力が向く。

以下、$c := \cos(\theta/2)$、$s := \sin(\theta/2)$ として議論する。

## 力の釣り合い方程式

LJ ポテンシャルの距離導関数は

$$
V'(r) = 24\,\frac{r^{6}-2}{r^{13}}
$$

である。

### 鋭角頂点 ($\theta$) での条件

鋭角頂点には、隣接 2 粒子 (距離 $a$) と短い対角線の向こう側の粒子 (距離 $p=2ac$) が作用する。力の合成は二等分線方向のみを考えればよく、

$$
2c\,V'(a) + V'(2ac) = 0
$$

を得る。この式は $a$ に関して線形な $a^6$ の方程式となり、正の解が一意に決まる:

$$
\boxed{\;a^6(c) = \frac{1 + 2^{14}c^{14}}{2^5c^6\bigl(1 + 2^8 c^8\bigr)}\;}.\tag{1}
$$

### 鈍角頂点 ($\pi-\theta$) での条件

鈍角頂点では隣接 2 粒子と長い対角線上の粒子 (距離 $q=2as$) が働き、同様に

$$
2s\,V'(a) + V'(2as) = 0\tag{2}
$$

が必要になる。式 (1) で得られた $a(c)$ を式 (2) に代入すると、$c$ に対する整式条件

$$
F(c) = (2c^2 - 1) \; P(c) = 0
$$

が現れる。ここで

$$
P(c) = 32768 c^{16} - 131072 c^{14} + 213248 c^{12} - 180992 c^{10} \\
 + 84224 c^{8} - 19712 c^{6} + 2817 c^{4} - 1281 c^{2} + 257.
$$

## 解の構造

$0 < \theta \le \pi/2$ (鋭角を採用) とすると、$c \in (0,1)$ の正の根は

$$
\begin{cases}
c_\mathrm{sq} = 1/\sqrt{2} & (\theta = 90^\circ),\\[4pt]
c_\mathrm{rh} \approx 0.8648447722454266 & (\theta \approx 60.2700300035^\circ).
\end{cases}
$$

$P(c)$ の他の正根 $c \approx 0.5020393609267666$ は補角 $\pi - \theta$ に対応するだけで、同じ菱形を表す。従って平衡条件を同時に満たす菱形は、正方形と $\theta \approx 60.27^\circ$（補角 $\approx 119.73^\circ$）の 2 通りしか存在しない。

対応する平衡辺長と対角線長は次の通りである。

| $\theta$ (deg) |      $a$       | 短対角線 $p=2ac$ | 長対角線 $q=2as$ |
| :------------: | :------------: | :--------------: | :--------------: |
|  $60.2700300$  | $1.1202309526$ |  $1.9376517661$  |  $1.1248000631$  |
|  $90.0000000$  | $1.1126198392$ |  $1.5734820663$  |  $1.5734820663$  |

(補角 $119.7299700^\circ$ でも $a$ は $1.1202309526$ で、短長対角線が入れ替わるだけである。)

## まとめ

- 菱形配置においては、正方形と特定角度 ($\theta \approx 60.27^\circ$) の菱形のみが平衡となる。
- いずれの場合も辺長は $a \approx 1.11$ 付近で、短対角線か長対角線のどちらかが $\approx 1.94$、もう一方が $\approx 1.12$ となる。

## 安定性解析 (数値)

`src/lj4_mode_analysis.py` を拡張し、平衡条件を満たす菱形に対してヘッセ行列の固有値解析を行った。固有値 (ω²) は質量行列で規格化したダイナミカルマトリクスの値であり、負値は不安定方向 (index) を表す。

### $\theta \approx 60.2700300^\circ$ 菱形

平衡配置の座標 (重心位置を原点に移したもの) は、辺長 $a = 1.1202309526$、角度 $\theta = 60.2700300^\circ$ に対して

$$
\begin{aligned}
\mathbf{r}_0 &= (-0.837884000,\ -0.486388727,\ 0),\\
\mathbf{r}_1 &= (\phantom{-}0.282346952,\ -0.486388727,\ 0),\\
\mathbf{r}_2 &= (\phantom{-}0.837884000,\ \phantom{-}0.486388727,\ 0),\\
\mathbf{r}_3 &= (-0.282346952,\ \phantom{-}0.486388727,\ 0)
\end{aligned}
$$

である。

- 使用パラメータ: `uv run src/lj4_mode_analysis.py --config rhombus --digits 8 --zero-tol 1e-10`
- 固有値スペクトル (ω²):

  | 種別          | $\lambda$      | $\omega$                 | 備考                                             |
  | :------------ | :------------- | :----------------------- | :----------------------------------------------- |
  | 不安定 (1 本) | $-0.46487407$  | $\omega = i\,0.68181674$ | 面外にジグザグで交互反転する $z$ 変位。          |
  | ゼロ (6 本)   | $\approx 0$    | $0$                      | 並進 3、本平面内回転 1、面外回転 2。             |
  | 安定 (1 本)   | $55.43013560$  | $\omega = 7.44514175$    | 2 本の対角線を伸縮させる面内変形。               |
  | 安定 (1 本)   | $59.71343001$  | $\omega = 7.72744654$    | 隣接辺が同位相で揺れる面内剪断。                 |
  | 安定 (1 本)   | $119.38078014$ | $\omega = 10.92615120$   | 対角線を保ったまま辺長を交互に変化させるモード。 |
  | 安定 (1 本)   | $171.29788972$ | $\omega = 13.08808197$   | 面内で対角線入れ替え型の高速振動。               |
  | 安定 (1 本)   | $178.11838214$ | $\omega = 13.34609988$   | 互い違いに平行移動する面内高周波。               |

- 固有ベクトル（ノルム 1、$(\delta x_0, \delta y_0, \delta z_0, \ldots, \delta x_3, \delta y_3, \delta z_3)$ 順）：

  - **不安定** $\lambda = -0.46487407$：
    - $P_0 = (0, 0, +0.500000)$
    - $P_1 = (0, 0, -0.500000)$
    - $P_2 = (0, 0, +0.500000)$
    - $P_3 = (0, 0, -0.500000)$
  - **安定** $\lambda = 55.43013560$：
    - $P_0 = (-0.520107, -0.301920, 0)$
    - $P_1 = (-0.186725, +0.321663, 0)$
    - $P_2 = (+0.520107, +0.301920, 0)$
    - $P_3 = (+0.186725, -0.321663, 0)$
  - **安定** $\lambda = 59.71343001$：
    - $P_0 = (-0.251020, +0.432422, 0)$
    - $P_1 = (+0.251020, -0.432422, 0)$
    - $P_2 = (-0.251020, +0.432422, 0)$
    - $P_3 = (+0.251020, -0.432422, 0)$
  - **安定** $\lambda = 119.38078014$：
    - $P_0 = (+0.178222, -0.307016, 0)$
    - $P_1 = (-0.528885, -0.307016, 0)$
    - $P_2 = (-0.178222, +0.307016, 0)$
    - $P_3 = (+0.528885, +0.307016, 0)$
  - **安定** $\lambda = 171.29788972$：
    - $P_0 = (+0.321663, +0.186725, 0)$
    - $P_1 = (-0.301920, +0.520107, 0)$
    - $P_2 = (-0.321663, -0.186725, 0)$
    - $P_3 = (+0.301920, -0.520107, 0)$
  - **安定** $\lambda = 178.11838214$：
    - $P_0 = (-0.432422, -0.251020, 0)$
    - $P_1 = (+0.432422, +0.251020, 0)$
    - $P_2 = (-0.432422, -0.251020, 0)$
    - $P_3 = (+0.432422, +0.251020, 0)$

短対角線と長対角線が非対称なため、唯一の不安定モードは長短対角線が交互に面外へ反転する変形に対応する。

### 正方形 ($\theta = 90^\circ$)

平衡配置の座標 (重心を原点に合わせたもの) は、辺長 $a = 1.1126198392$ に対し

$$
\begin{aligned}
\mathbf{r}_0 &= (-0.556309920,\ -0.556309920,\ 0),\\
\mathbf{r}_1 &= (\phantom{-}0.556309920,\ -0.556309920,\ 0),\\
\mathbf{r}_2 &= (\phantom{-}0.556309920,\ \phantom{-}0.556309920,\ 0),\\
\mathbf{r}_3 &= (-0.556309920,\ \phantom{-}0.556309920,\ 0)
\end{aligned}
$$

となる。

- 使用パラメータ: `uv run src/lj4_mode_analysis.py --config square --digits 8 --zero-tol 1e-10`
- 固有値スペクトル (ω²):

  | 種別          | $\lambda$      | $\omega$                 | 備考                                        |
  | :------------ | :------------- | :----------------------- | :------------------------------------------ |
  | 不安定 (1 本) | $-7.86280762$  | $\omega = i\,2.80406983$ | 面内で対角線が膨らむ屈曲モード。            |
  | 不安定 (1 本) | $-2.21822281$  | $\omega = i\,1.48936994$ | 交互の粒子が $z$ 方向へ反転する面外モード。 |
  | ゼロ (6 本)   | $\approx 0$    | $0$                      | 並進 3、本平面内回転 1、面外回転 2。        |
  | 安定 (1 本)   | $130.30078427$ | $\omega = 11.41493689$   | 向かい合う粒子が同相で動く伸張振動。        |
  | 安定 (2 重)   | $135.94536908$ | $\omega = 11.65956127$   | 面内で互い違いに動く 2 重縮退の振動。       |
  | 安定 (1 本)   | $138.16359189$ | $\omega = 11.75430100$   | 隣り合う粒子が正負に動く高速モード。        |

- 固有ベクトル（ノルム 1）：

  - **不安定** $\lambda = -7.86280762$：
    - $P_0 = (-0.353553, -0.353553, 0)$
    - $P_1 = (-0.353553, +0.353553, 0)$
    - $P_2 = (+0.353553, +0.353553, 0)$
    - $P_3 = (+0.353553, -0.353553, 0)$
  - **不安定** $\lambda = -2.21822281$：
    - $P_0 = (0, 0, -0.500000)$
    - $P_1 = (0, 0, +0.500000)$
    - $P_2 = (0, 0, -0.500000)$
    - $P_3 = (0, 0, +0.500000)$
  - **安定** $\lambda = 130.30078427$：
    - $P_0 = (+0.353553, +0.353553, 0)$
    - $P_1 = (-0.353553, +0.353553, 0)$
    - $P_2 = (-0.353553, -0.353553, 0)$
    - $P_3 = (+0.353553, -0.353553, 0)$
  - **安定（縮退 1）** $\lambda = 135.94536908$：
    - $P_0 = (+0.091135, +0.491624, 0)$
    - $P_1 = (-0.091135, -0.491624, 0)$
    - $P_2 = (+0.091135, +0.491624, 0)$
    - $P_3 = (-0.091135, -0.491624, 0)$
  - **安定（縮退 2）** $\lambda = 135.94536908$：
    - $P_0 = (+0.491624, -0.091135, 0)$
    - $P_1 = (-0.491624, +0.091135, 0)$
    - $P_2 = (+0.491624, -0.091135, 0)$
    - $P_3 = (-0.491624, +0.091135, 0)$
  - **安定** $\lambda = 138.16359189$：
    - $P_0 = (+0.353553, -0.353553, 0)$
    - $P_1 = (-0.353553, -0.353553, 0)$
    - $P_2 = (-0.353553, +0.353553, 0)$
    - $P_3 = (+0.353553, +0.353553, 0)$

正方形では 2 本の負固有値が存在し、既報の屈曲モードに加えて $z$ 方向の交互反転モードも不安定であることが確認できる。

## モード励起による崩壊時間の測定

不安定モードを含む菱形配置が、mode 0 のみの速度励起でどの程度持続するかを調べた。`uv run python src/lj4_3d.py --config rhombus --modes 0 --mode-displacement 0 --mode-velocity v --dt 0.002 --T 220 --thin 20` として time series を `results/rhombus_long/mode0_velXX_T220.json` に保存し、ポテンシャルが $V \le -5.2$ に落ち込む最初のサンプル時刻を「崩壊時間」と定義した。初期運動エネルギー $K_0$ は mode 0 の速度振幅から得られる。

| $v$ | $K_0$ | 崩壊時間 $T_\mathrm{break}$ | 備考 |
| :-- | :---- | :-------------------------- | :--- |
| 0.4 | 0.08  | 71.32                       | 数十周期で四面体側へ遷移し始める |
| 0.5 | 0.125 | 72.60                       | $T\approx 70$ 過ぎで $V$ が急落し、$K$ が 0.5 付近まで上昇 |
| 0.6 | 0.18  | 74.04                       | 崩壊までわずかに延びるが $V\to -6$ 付近は同様 |
| 0.8 | 0.32  | 79.84                       | より大きな振幅で数周期延命 |
| 1.0 | 0.50  | 85.76                       | 80 を超えるまで菱形を維持するが、その後急落 |
| 1.2 | 0.72  | 91.12                       | 崩壊直後に $K$ が 1.6 近くまで跳ね上がる |
| 1.4 | 0.98  | 137.32                      | 130 付近まで保つが最終的には崩壊 |

初期運動エネルギーと崩壊時間の関係は `results/rhombus_long/collapse_time_vs_k0.png` にプロットし、数値データを `results/rhombus_long/collapse_times.csv` にまとめた。初期速度を大きくするほど崩壊は遅れるが、特に 1.0 以上でも時間経過と共に四面体側へ滑り落ちる傾向が残ることが確認できる。また、任意の構成・閾値で同種のスキャンを自動化するために `src/scan_mode_collapse.py` を用意しており、初期運動エネルギー範囲・サンプル数・崩壊閾値に加えて、総運動エネルギーを固定した 2 モード混合 (`--mode-index` と `--secondary-mode`) も引数で制御できる。

## 今後の展開

- 不安定固有ベクトルの幾何を解析し、どの遷移経路に対応するか整理する。
- index-1 鞍点 ($\theta \approx 60.27^\circ$) を含む最小エネルギー経路や遷移状態探索に接続する。
